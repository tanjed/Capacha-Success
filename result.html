<!DOCTYPE html>
<html>
<head>
	<title>Drag & Drop Result</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<link rel="stylesheet" href="dragndrop.css">

</head>
<body style="background-color: 76b5a5">

	<div class="result text-center" style="margin-bottom: 1%">
		<h3 style="color: white; margin-bottom: 1%;">Result Summary</h3>
		<button type="button" id="export" class="btn btn-warning" style="margin-bottom: 1%">Export Data</button>
	</div>

<div class="container-fluid">
  

    Name: <span id="name"></span> || Age: <span id="age"></span> || Type: <span id="type"></span> || CAPTCHA Type: <span id="capacha_type"></span> || Mobility Problem: <span id="mobility_problem"></span> || Vision Problem: <span id="vision_problem"></span> <br><b><i>Time Taken: <span id="time"></span> Sec</i></b> <br><b><i> Tired: <span id="try"></span></i></b><br><br>
		<table class="table table-dark" id="resultTable">
  <thead>
    <tr><td colspan="17" style="text-align: center;display: none;"><span id="user_name"></span></td></tr>
    <tr id="table_head">
      <th scope="col">Drag</th>
      <th scope="col">Position</th>
    <!--   <th scope="col">1</th>
      <th scope="col">2</th>
      <th scope="col">3</th>
      <th scope="col">4</th>
      <th scope="col">5</th>
      <th scope="col">6</th>
      <th scope="col">7</th>
      <th scope="col">8</th>
      <th scope="col">9</th>
      <th scope="col">10</th>
      <th scope="col">11</th>
      <th scope="col">12</th>
      <th scope="col">13</th>
      <th scope="col">14</th>
      <th scope="col">15</th>
      <th scope="col">16</th>
      <th scope="col">17</th>
      <th scope="col">18</th>
      <th scope="col">19</th>
      <th scope="col">20</th>
      <th scope="col">21</th>
      <th scope="col">22</th>
      <th scope="col">23</th>
      <th scope="col">24</th>
      <th scope="col">25</th>
      <th scope="col">26</th>
      <th scope="col">27</th>
      <th scope="col">28</th>
      <th scope="col">29</th>
      <th scope="col">30</th>
      <th scope="col">31</th>
      <th scope="col">32</th>
      <th scope="col">33</th>
      <th scope="col">34</th>
      <th scope="col">35</th>
      <th scope="col">36</th>
      <th scope="col">37</th>
      <th scope="col">38</th>
      <th scope="col">39</th>
      <th scope="col">40</th>
      <th scope="col">41</th>
      <th scope="col">42</th>
      <th scope="col">43</th>
      <th scope="col">44</th>
      <th scope="col">45</th>
      <th scope="col">46</th>
      <th scope="col">47</th>
      <th scope="col">48</th>
      <th scope="col">49</th>
      <th scope="col">50</th>
      <th scope="col">51</th>
      <th scope="col">52</th>
      <th scope="col">53</th>
      <th scope="col">54</th>
      <th scope="col">55</th>
      <th scope="col">56</th>
      <th scope="col">57</th>
      <th scope="col">58</th>
      <th scope="col">59</th>
      <th scope="col">60</th>   -->    
    </tr>
  </thead>
  <tbody id="tbody">
    <!-- <tr>
      <td>1</td>
      <td>x  <br> y</td>
      <td>0  <br> 0</td>
      <td>2  <br> 4</td>
      <td>4  <br> 6</td>
      <td>6  <br> 8</td>
      <td>8  <br> 10</td>
      <td>10 <br> 12</td>
      <td>12 <br> 14</td>
      <td>14 <br> 16</td>
      <td>16 <br> 18</td>
      <td>18 <br> 20</td>
      <td>20 <br> 22</td>
      <td>22 <br> 24</td>
      <td>24 <br> 26</td>
      <td>26 <br> 28</td>
      <td>28 <br> 30</td>
    </tr> -->
  </tbody>
</table>
<br>
	</div>
	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
 <script src="personal_lib.js"></script>

  <script type="text/javascript">
    console.log(localStorage);
    var coordinate_length = [];

   setData(getLocal('user'));

    $('#time').html(getLocal('time'));
    $('#try').html(getLocal('trial'));

   var user_name = getLocal('user').name;
   $('#user_name').html(user_name);
   

   $("#export").click(function(){
      exportTableToExcel('resultTable', user_name );
  });

  
   for(var i = 1; i<=4; i++){
    var coordinates = getLocal('coordinate'+i);
    coordinate_length.push(coordinates.length);
    if (coordinates === null) {
      break;
    }
    var temp = $("#tbody").append($('<tr>'));
        temp.append($('<td>').html(i)).append('<td>x <br> y</td>');
      for(var j=0;j<coordinates.length;j++){
          if(!!coordinates[j]){
            temp.append($('<td>').html(coordinates[j].x+'<br>'+coordinates[j].y));
          }else{
            temp.append($('<td>').html(''));
          }
      }
   }
    for(var i = 1; i<=Math.max(...coordinate_length); i++){
    $('#table_head').append('<th>'+i+'</th>');
  }
 
       
  </script>

</body>
</html>